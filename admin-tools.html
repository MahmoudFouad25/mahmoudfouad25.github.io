<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª - Ù…Ø­Ù…ÙˆØ¯ ÙØ¤Ø§Ø¯</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary: #2C5530;
    --secondary: #8B9467;
    --accent: #D4AF37;
    --light: #F5F2E8;
    --dark: #1A1A1A;
    --gradient: linear-gradient(135deg, #2C5530 0%, #8B9467 100%);
    --success: #28a745;
    --danger: #dc3545;
    --warning: #ffc107;
    --info: #17a2b8;
    
    /* Tool Type Colors */
    --practice-color: #3498db;
    --meditation-color: #9b59b6;
    --game-color: #e74c3c;
    --challenge-color: #f39c12;
    --reflection-color: #1abc9c;
    --voice-color: #34495e;
}

body {
    font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
    background: #f5f5f5;
    color: var(--dark);
    min-height: 100vh;
}

/* Navigation - Same as other admin pages */
.admin-nav {
    background: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 1rem 2rem;
    position: sticky;
    top: 0;
    z-index: 1000;
}

/* Container */
.tools-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}

/* Page Header */
.page-header {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.page-header h1 {
    color: var(--primary);
    font-size: 2rem;
}

.header-actions {
    display: flex;
    gap: 1rem;
}

/* Tool Types Grid */
.tool-types-section {
    background: white;
    padding: 1.5rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
}

.tool-types-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.tool-type-card {
    padding: 1.5rem;
    border-radius: 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
    position: relative;
}

.tool-type-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.tool-type-card.active {
    border-color: var(--primary);
    background: rgba(44, 85, 48, 0.05);
}

.tool-type-icon {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    display: block;
}

.tool-type-name {
    font-weight: 600;
    color: var(--dark);
    margin-bottom: 0.3rem;
}

.tool-type-count {
    font-size: 0.9rem;
    color: #666;
}

.add-type-card {
    border: 2px dashed #ddd;
    background: #fafafa;
}

.add-type-card:hover {
    border-color: var(--primary);
    background: white;
}

/* Filters and Search */
.tools-controls {
    background: white;
    padding: 1.5rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
}

.controls-row {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
}

.search-box {
    flex: 1;
    min-width: 300px;
    position: relative;
}

.search-box input {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 3rem;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}

.search-icon {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: #666;
}

.filter-group {
    display: flex;
    gap: 0.5rem;
}

.filter-btn {
    padding: 0.5rem 1rem;
    border: 2px solid #ddd;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
}

.filter-btn:hover {
    border-color: var(--primary);
}

.filter-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.view-toggle {
    display: flex;
    gap: 0.5rem;
    background: #f0f0f0;
    padding: 0.25rem;
    border-radius: 8px;
}

.view-btn {
    padding: 0.5rem;
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.3s;
}

.view-btn.active {
    background: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Tools Grid */
.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 1.5rem;
}

.tool-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    overflow: hidden;
    transition: all 0.3s;
    position: relative;
}

.tool-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

.tool-card-header {
    padding: 1.5rem;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
}

.tool-card-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.tool-name {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary);
}

.tool-type-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    color: white;
}

.tool-type-practice { background: var(--practice-color); }
.tool-type-meditation { background: var(--meditation-color); }
.tool-type-game { background: var(--game-color); }
.tool-type-challenge { background: var(--challenge-color); }
.tool-type-reflection { background: var(--reflection-color); }
.tool-type-voice { background: var(--voice-color); }

.tool-description {
    color: #666;
    font-size: 0.9rem;
    line-height: 1.5;
}

.tool-card-body {
    padding: 1.5rem;
}

.tool-meta {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 1rem;
}

.meta-item {
    text-align: center;
}

.meta-label {
    font-size: 0.8rem;
    color: #666;
    display: block;
}

.meta-value {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--primary);
}

.tool-stats {
    display: flex;
    justify-content: space-between;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 10px;
    margin-bottom: 1rem;
}

.stat-item {
    text-align: center;
}

.stat-value {
    display: block;
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--primary);
}

.stat-label {
    font-size: 0.8rem;
    color: #666;
}

.tool-actions {
    display: flex;
    gap: 0.5rem;
}

.btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.9rem;
    flex: 1;
    text-align: center;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.btn-primary {
    background: var(--primary);
    color: white;
}

.btn-secondary {
    background: white;
    color: var(--primary);
    border: 2px solid var(--primary);
}

.btn-icon {
    padding: 0.5rem;
    min-width: auto;
    flex: none;
}

/* Tool Creator Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    overflow-y: auto;
}

.modal-content {
    background-color: white;
    margin: 2% auto;
    padding: 0;
    border-radius: 15px;
    width: 95%;
    max-width: 900px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.modal-header {
    background: var(--gradient);
    color: white;
    padding: 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h2 {
    font-size: 1.5rem;
    margin: 0;
}

.close {
    color: white;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal-body {
    flex: 1;
    overflow-y: auto;
    padding: 2rem;
}

/* Tool Creator Steps */
.creator-steps {
    display: flex;
    justify-content: space-between;
    margin-bottom: 2rem;
    padding: 0 2rem;
}

.step {
    flex: 1;
    text-align: center;
    position: relative;
}

.step::after {
    content: '';
    position: absolute;
    top: 20px;
    right: -50%;
    width: 100%;
    height: 2px;
    background: #ddd;
}

.step:last-child::after {
    display: none;
}

.step-number {
    width: 40px;
    height: 40px;
    background: #ddd;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.5rem;
    font-weight: bold;
    position: relative;
    z-index: 1;
}

.step.active .step-number {
    background: var(--primary);
}

.step.completed .step-number {
    background: var(--success);
}

.step-title {
    font-size: 0.9rem;
    color: #666;
}

.step.active .step-title {
    color: var(--primary);
    font-weight: 600;
}

/* Form Sections */
.form-section {
    display: none;
}

.form-section.active {
    display: block;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--primary);
    font-weight: 600;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s;
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(44, 85, 48, 0.1);
}

/* Type Specific Content */
.type-specific-content {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: 10px;
    margin-top: 1rem;
}

/* Steps Builder */
.steps-builder {
    margin-top: 1rem;
}

.step-item {
    background: white;
    padding: 1.5rem;
    border-radius: 10px;
    margin-bottom: 1rem;
    border: 2px solid #e9ecef;
    position: relative;
}

.step-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.step-handle {
    cursor: move;
    color: #666;
    margin-left: 0.5rem;
}

.remove-step {
    color: var(--danger);
    cursor: pointer;
}

.add-step-btn {
    width: 100%;
    padding: 1rem;
    border: 2px dashed #ddd;
    background: transparent;
    color: var(--primary);
    font-weight: 600;
    cursor: pointer;
    border-radius: 10px;
    transition: all 0.3s;
}

.add-step-btn:hover {
    background: rgba(44, 85, 48, 0.05);
    border-color: var(--primary);
}

/* Tracking Setup */
.measurement-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.measurement-option {
    padding: 1rem;
    border: 2px solid #ddd;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.measurement-option:hover {
    border-color: var(--primary);
}

.measurement-option.selected {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.measurement-icon {
    font-size: 2rem;
    display: block;
    margin-bottom: 0.5rem;
}

/* Questions Builder */
.questions-builder {
    margin-top: 1rem;
}

.question-item {
    background: white;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    display: flex;
    gap: 1rem;
    align-items: center;
}

.question-input {
    flex: 1;
}

.question-type {
    width: 150px;
}

.remove-question {
    color: var(--danger);
    cursor: pointer;
    padding: 0.5rem;
}

/* Automation Setup */
.reminder-setup {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: 10px;
    margin-top: 1rem;
}

.time-picker-group {
    display: flex;
    gap: 1rem;
    align-items: center;
}

.channel-options {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
}

.channel-option {
    flex: 1;
    padding: 0.75rem;
    border: 2px solid #ddd;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
}

.channel-option:hover {
    border-color: var(--primary);
}

.channel-option.selected {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Preview Section */
.tool-preview {
    background: white;
    border: 2px solid #e9ecef;
    border-radius: 15px;
    padding: 2rem;
    margin-top: 2rem;
}

.preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #e9ecef;
}

.preview-title {
    font-size: 1.3rem;
    color: var(--primary);
}

/* Action Buttons */
.action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 2px solid #e9ecef;
}

.btn-large {
    padding: 1rem 2rem;
    font-size: 1.1rem;
}

/* Loading State */
.loading {
    text-align: center;
    padding: 3rem;
}

.spinner {
    border: 3px solid #f3f3f3;
    border-top: 3px solid var(--primary);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: #999;
}

.empty-state-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

/* Notification */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 8px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    z-index: 10000;
    animation: slideIn 0.3s;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.notification.success {
    background: var(--success);
    color: white;
}

.notification.error {
    background: var(--danger);
    color: white;
}

/* Tool Stats Dashboard */
.stats-dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: white;
    padding: 1.5rem;
    border-radius: 10px;
    box-shadow: 0 3px 15px rgba(0,0,0,0.1);
    text-align: center;
}

.stat-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    opacity: 0.8;
}

.stat-number {
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary);
}

.stat-title {
    font-size: 0.9rem;
    color: #666;
    margin-top: 0.5rem;
}

/* Responsive */
@media (max-width: 768px) {
    .tools-container {
        padding: 1rem;
    }
    
    .page-header {
        flex-direction: column;
        gap: 1rem;
    }
    
    .controls-row {
        flex-direction: column;
    }
    
    .search-box {
        min-width: 100%;
    }
    
    .tools-grid {
        grid-template-columns: 1fr;
    }
    
    .modal-content {
        width: 100%;
        margin: 0;
        border-radius: 0;
        height: 100%;
        max-height: 100%;
    }
    
    .creator-steps {
        padding: 0 1rem;
    }
    
    .step-title {
        font-size: 0.8rem;
    }
}
</style>
</head>
<body>

<!-- Navigation -->
<nav class="admin-nav">
    <div class="nav-container" style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
        <div class="nav-brand">
            <h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø­Ù…ÙˆØ¯ ÙØ¤Ø§Ø¯</h2>
        </div>
        <div class="nav-links" style="display: flex; gap: 2rem; align-items: center;">
            <a href="admin-dashboard.html" style="color: var(--dark); text-decoration: none;">
                <span>ğŸ </span> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                        <a href="admin-bookings.html" style="color: var(--dark); text-decoration: none;">
        <span>ğŸ“…</span>
        <span>Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</span>    
            </a>
            <a href="central-dashboard.html" style="color: var(--dark); text-decoration: none;">
                <span>ğŸš€</span> Ø§Ù„Ø±Ø­Ù„Ø§Øª
            </a>
            <a href="admin-tools.html" class="active" style="color: var(--primary); text-decoration: none; position: relative;">
                <span>ğŸ§°</span> Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª
                <span style="position: absolute; bottom: -5px; left: 0; right: 0; height: 3px; background: var(--accent);"></span>
            </a>
            <a href="admin-journey-tools.html" style="color: var(--dark); text-decoration: none;">
                <span>ğŸš€</span> ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ø¯ÙˆØ§Øª
            </a>
            <a href="#" onclick="logout()" style="color: var(--dark); text-decoration: none;">
                <span>ğŸšª</span> Ø®Ø±ÙˆØ¬
            </a>
        </div>
    </div>
</nav>

<!-- Main Container -->
<div class="tools-container">
    <!-- Page Header -->
    <div class="page-header">
        <div>
            <h1>ğŸ§° Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª</h1>
            <p style="color: #666; margin-top: 0.5rem;">Ø£Ù†Ø´Ø¦ ÙˆØ£Ø¯Ø± Ø£Ø¯ÙˆØ§ØªÙƒ Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡</p>
        </div>
        <div class="header-actions">
            <button class="btn btn-primary btn-large" onclick="openToolCreator()">
                <span>â•</span> Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¯Ø§Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </button>
        </div>
    </div>

    <!-- Stats Dashboard -->
    <div class="stats-dashboard">
        <div class="stat-card">
            <div class="stat-icon">ğŸ§°</div>
            <div class="stat-number" id="totalToolsCount">0</div>
            <div class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯ÙˆØ§Øª</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-number" id="activeUsageCount">0</div>
            <div class="stat-title">Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª Ù†Ø´Ø·Ø©</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">â­</div>
            <div class="stat-number" id="avgRating">0</div>
            <div class="stat-title">Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">âœ…</div>
            <div class="stat-number" id="completionRate">0%</div>
            <div class="stat-title">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</div>
        </div>
    </div>

    <!-- Tool Types -->
    <div class="tool-types-section">
        <h3 style="color: var(--primary); margin-bottom: 1rem;">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯ÙˆØ§Øª</h3>
        <div class="tool-types-grid" id="toolTypesGrid">
            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
        </div>
    </div>

    <!-- Filters and Search -->
    <div class="tools-controls">
        <div class="controls-row">
            <div class="search-box">
                <span class="search-icon">ğŸ”</span>
                <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¯Ø§Ø©..." onkeyup="filterTools()">
            </div>
            
            <div class="filter-group">
                <button class="filter-btn active" onclick="filterByProgram('all')">ÙƒÙ„ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬</button>
                <button class="filter-btn" onclick="filterByProgram('clarity')">Ø§Ù„ÙˆØ¶ÙˆØ­</button>
                <button class="filter-btn" onclick="filterByProgram('discovery')">Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</button>
                <button class="filter-btn" onclick="filterByProgram('transformation')">Ø§Ù„ØªØ­ÙˆÙ„</button>
            </div>
            
            <div class="view-toggle">
                <button class="view-btn active" onclick="switchView('grid')">âŠ</button>
                <button class="view-btn" onclick="switchView('list')">â˜°</button>
            </div>
        </div>
    </div>

    <!-- Tools Grid -->
    <div id="toolsGrid" class="tools-grid">
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
    </div>

    <!-- Empty State -->
    <div id="emptyState" class="empty-state" style="display: none;">
        <div class="empty-state-icon">ğŸ§°</div>
        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯ÙˆØ§Øª Ø¨Ø¹Ø¯</h3>
        <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆÙ„ Ø£Ø¯Ø§Ø© ÙÙŠ Ù…ÙƒØªØ¨ØªÙƒ</p>
        <button class="btn btn-primary" onclick="openToolCreator()">Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¯Ø§Ø©</button>
    </div>
</div>

<!-- Tool Creator Modal -->
<div id="toolCreatorModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¯Ø§Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <span class="close" onclick="closeToolCreator()">&times;</span>
        </div>
        
        <div class="modal-body">
            <!-- Creator Steps -->
            <div class="creator-steps">
                <div class="step active" id="step1">
                    <div class="step-number">1</div>
                    <div class="step-title">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</div>
                </div>
                <div class="step" id="step2">
                    <div class="step-number">2</div>
                    <div class="step-title">Ø§Ù„Ù…Ø­ØªÙˆÙ‰</div>
                </div>
                <div class="step" id="step3">
                    <div class="step-number">3</div>
                    <div class="step-title">Ø§Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„Ù‚ÙŠØ§Ø³</div>
                </div>
                <div class="step" id="step4">
                    <div class="step-number">4</div>
                    <div class="step-title">Ø§Ù„Ø£ØªÙ…ØªØ©</div>
                </div>
            </div>

            <!-- Step 1: Basic Info -->
            <div class="form-section active" id="section1">
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©</label>
                    <input type="text" id="toolName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø«Ù„Ø« Ø§Ù„Ù‚Ù„Ø¨ÙŠ">
                </div>
                
                <div class="form-group">
                    <label>Ù†ÙˆØ¹ Ø§Ù„Ø£Ø¯Ø§Ø©</label>
                    <select id="toolType" onchange="updateTypeSpecificFields()">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                        <option value="practice">Ù…Ù…Ø§Ø±Ø³Ø©</option>
                        <option value="meditation">ØªØ£Ù…Ù„</option>
                        <option value="game">Ù„Ø¹Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ©</option>
                        <option value="challenge">ØªØ­Ø¯ÙŠ</option>
                        <option value="reflection">ØªØ£Ù…Ù„ ÙƒØªØ§Ø¨ÙŠ</option>
                        <option value="voice">ØªÙ…Ø±ÙŠÙ† ØµÙˆØªÙŠ</option>
                        <option value="custom">Ù†ÙˆØ¹ Ù…Ø®ØµØµ</option>
                    </select>
                </div>
                
                <div class="form-group" id="customTypeGroup" style="display: none;">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®ØµØµ</label>
                    <input type="text" id="customTypeName" placeholder="Ù…Ø«Ø§Ù„: ØªÙ…Ø±ÙŠÙ† ØªÙ†ÙØ³">
                </div>
                
                <div class="form-group">
                    <label>ÙˆØµÙ Ø§Ù„Ø£Ø¯Ø§Ø©</label>
                    <textarea id="toolDescription" rows="4" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ø£Ø¯Ø§Ø© ÙˆÙÙˆØ§Ø¦Ø¯Ù‡Ø§..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</label>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="targetAll" onchange="toggleAllPrograms()">
                            <span>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="targetClarity" class="program-check">
                            <span>Ø§Ù„ÙˆØ¶ÙˆØ­</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="targetDiscovery" class="program-check">
                            <span>Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="targetTransformation" class="program-check">
                            <span>Ø§Ù„ØªØ­ÙˆÙ„</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)</label>
                    <input type="number" id="defaultDuration" value="15" min="1">
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
                    <select id="defaultFrequency">
                        <option value="daily">ÙŠÙˆÙ…ÙŠØ§Ù‹</option>
                        <option value="every2days">ÙƒÙ„ ÙŠÙˆÙ…ÙŠÙ†</option>
                        <option value="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</option>
                        <option value="asneeded">Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©</option>
                    </select>
                </div>
            </div>

            <!-- Step 2: Content -->
            <div class="form-section" id="section2">
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ø¯Ø§Ø©</h3>
                
                <!-- Type Specific Content will be inserted here -->
                <div id="typeSpecificContent"></div>
            </div>

            <!-- Step 3: Tracking -->
            <div class="form-section" id="section3">
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">Ø§Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„Ù‚ÙŠØ§Ø³</h3>
                
                <div class="form-group">
                    <label>ÙƒÙŠÙ Ø³ÙŠØªÙ… Ù‚ÙŠØ§Ø³ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©ØŸ</label>
                    <div class="measurement-options">
                        <div class="measurement-option" onclick="selectMeasurement('binary')">
                            <span class="measurement-icon">âœ…</span>
                            <div>ØªÙ… / Ù„Ù… ÙŠØªÙ…</div>
                        </div>
                        <div class="measurement-option" onclick="selectMeasurement('scale')">
                            <span class="measurement-icon">ğŸ“Š</span>
                            <div>Ù…Ù‚ÙŠØ§Ø³ (1-10)</div>
                        </div>
                        <div class="measurement-option" onclick="selectMeasurement('duration')">
                            <span class="measurement-icon">â±ï¸</span>
                            <div>Ø§Ù„Ù…Ø¯Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©</div>
                        </div>
                        <div class="measurement-option" onclick="selectMeasurement('quality')">
                            <span class="measurement-icon">â­</span>
                            <div>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡</div>
                        </div>
                        <div class="measurement-option" onclick="selectMeasurement('text')">
                            <span class="measurement-icon">ğŸ“</span>
                            <div>Ù†Øµ Ù…ÙØªÙˆØ­</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­</label>
                    <textarea id="successCriteria" rows="3" placeholder="Ù…ØªÙ‰ ØªØ¹ØªØ¨Ø± Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù†Ø§Ø¬Ø­Ø©ØŸ"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</label>
                    <div class="questions-builder" id="questionsBuilder">
                        <div class="question-item">
                            <input type="text" class="question-input" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„">
                            <select class="question-type">
                                <option value="text">Ù†Øµ</option>
                                <option value="scale">Ù…Ù‚ÙŠØ§Ø³</option>
                                <option value="choice">Ø§Ø®ØªÙŠØ§Ø±</option>
                            </select>
                            <span class="remove-question" onclick="removeQuestion(this)">âŒ</span>
                        </div>
                    </div>
                    <button class="add-step-btn" onclick="addQuestion()">+ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</button>
                </div>
            </div>

            <!-- Step 4: Automation -->
            <div class="form-section" id="section4">
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">Ø§Ù„Ø£ØªÙ…ØªØ© ÙˆØ§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</h3>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="enableReminders" onchange="toggleReminders()">
                        ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
                    </label>
                </div>
                
                <div class="reminder-setup" id="reminderSetup" style="display: none;">
                    <div class="form-group">
                        <label>ÙˆÙ‚Øª Ø§Ù„ØªØ°ÙƒÙŠØ±</label>
                        <div class="time-picker-group">
                            <input type="time" id="reminderTime" value="09:00">
                            <select id="reminderTiming">
                                <option value="exact">ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯</option>
                                <option value="before">Ù‚Ø¨Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø© Ø¨Ù€</option>
                                <option value="after">Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ù€</option>
                            </select>
                            <input type="number" id="reminderOffset" value="30" min="5" style="width: 80px; display: none;">
                            <span id="offsetUnit" style="display: none;">Ø¯Ù‚ÙŠÙ‚Ø©</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</label>
                        <div class="channel-options">
                            <div class="channel-option selected" onclick="toggleChannel(this, 'whatsapp')">
                                <span>ğŸ“±</span> ÙˆØ§ØªØ³Ø§Ø¨
                            </div>
                            <div class="channel-option" onclick="toggleChannel(this, 'email')">
                                <span>ğŸ“§</span> Ø¥ÙŠÙ…ÙŠÙ„
                            </div>
                            <div class="channel-option" onclick="toggleChannel(this, 'push')">
                                <span>ğŸ””</span> Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ°ÙƒÙŠØ±</label>
                        <textarea id="reminderMessage" rows="3" placeholder="Ù…Ø±Ø­Ø¨Ø§Ù‹ {Ø§Ù„Ø§Ø³Ù…}ØŒ Ø­Ø§Ù† ÙˆÙ‚Øª {Ø§Ø³Ù…_Ø§Ù„Ø£Ø¯Ø§Ø©}! ğŸŒŸ"></textarea>
                        <small style="color: #666;">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…: {Ø§Ù„Ø§Ø³Ù…}, {Ø§Ø³Ù…_Ø§Ù„Ø£Ø¯Ø§Ø©}, {Ø§Ù„ÙˆÙ‚Øª}</small>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ø±Ø³Ø§Ø¦Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</label>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: normal;">Ø¹Ù†Ø¯ Ø§Ù„ØªØ®ØµÙŠØµ:</label>
                        <input type="text" id="msgOnAssign" placeholder="ØªÙ… Ø¥Ø¶Ø§ÙØ© {Ø§Ø³Ù…_Ø§Ù„Ø£Ø¯Ø§Ø©} Ù„Ø±Ø­Ù„ØªÙƒ! ğŸ¯">
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: normal;">Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„:</label>
                        <input type="text" id="msgOnComplete" placeholder="Ø£Ø­Ø³Ù†Øª! Ø£ÙƒÙ…Ù„Øª {Ø§Ø³Ù…_Ø§Ù„Ø£Ø¯Ø§Ø©} Ø¨Ù†Ø¬Ø§Ø­ ğŸ‰">
                    </div>
                    
                    <div>
                        <label style="font-weight: normal;">Ø¹Ù†Ø¯ Ø§Ù„ØªØ®Ø·ÙŠ:</label>
                        <input type="text" id="msgOnSkip" placeholder="Ù„Ø§ Ø¨Ø£Ø³ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹ ğŸ’ª">
                    </div>
                </div>
                
                <!-- Preview Section -->
                <div class="tool-preview">
                    <div class="preview-header">
                        <h4 class="preview-title">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ø¯Ø§Ø©</h4>
                        <button class="btn btn-secondary" onclick="refreshPreview()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
                    </div>
                    <div id="toolPreview">
                        <!-- Preview content will be generated here -->
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-secondary btn-large" id="prevBtn" onclick="previousStep()" style="display: none;">
                    Ø§Ù„Ø³Ø§Ø¨Ù‚
                </button>
                <button class="btn btn-primary btn-large" id="nextBtn" onclick="nextStep()">
                    Ø§Ù„ØªØ§Ù„ÙŠ
                </button>
                <button class="btn btn-success btn-large" id="saveBtn" onclick="saveTool()" style="display: none;">
                    ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø£Ø¯Ø§Ø©
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 9999; display: flex; justify-content: center; align-items: center;">
    <div class="spinner"></div>
</div>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>

<script>
// Initialize
const auth = firebase.auth();
const db = firebase.firestore();

// State
let allTools = [];
let filteredTools = [];
let currentStep = 1;
let selectedMeasurement = null;
let selectedChannels = ['whatsapp'];
let currentFilter = 'all';
let currentView = 'grid';

// Tool Types Configuration
const toolTypes = [
    { id: 'practice', name: 'Ù…Ù…Ø§Ø±Ø³Ø§Øª', icon: 'ğŸ¯', color: 'var(--practice-color)' },
    { id: 'meditation', name: 'ØªØ£Ù…Ù„Ø§Øª', icon: 'ğŸ§˜', color: 'var(--meditation-color)' },
    { id: 'game', name: 'Ø£Ù„Ø¹Ø§Ø¨ ØªÙØ§Ø¹Ù„ÙŠØ©', icon: 'ğŸ®', color: 'var(--game-color)' },
    { id: 'challenge', name: 'ØªØ­Ø¯ÙŠØ§Øª', icon: 'ğŸ†', color: 'var(--challenge-color)' },
    { id: 'reflection', name: 'ØªØ£Ù…Ù„Ø§Øª ÙƒØªØ§Ø¨ÙŠØ©', icon: 'ğŸ“', color: 'var(--reflection-color)' },
    { id: 'voice', name: 'ØªÙ…Ø§Ø±ÙŠÙ† ØµÙˆØªÙŠØ©', icon: 'ğŸ™ï¸', color: 'var(--voice-color)' }
];

// Check authentication on load
window.onload = function() {
    checkAuth();
};

// Check authentication
function checkAuth() {
    const authToken = sessionStorage.getItem('adminAuth');
    const authTime = sessionStorage.getItem('authTime');
    const oneHour = 60 * 60 * 1000;
    
    if (authToken === 'true' && authTime && (Date.now() - parseInt(authTime) < oneHour)) {
        loadTools();
        loadToolTypes();
        setInterval(loadTools, 30000); // Refresh every 30 seconds
    } else {
        window.location.href = 'admin-dashboard.html';
    }
}

// Logout
function logout() {
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
        sessionStorage.clear();
        window.location.href = 'admin-dashboard.html';
    }
}

// Load tool types
function loadToolTypes() {
    const container = document.getElementById('toolTypesGrid');
    let html = '';
    
    // Add existing types
    toolTypes.forEach(type => {
        html += `
            <div class="tool-type-card" onclick="filterByType('${type.id}')" data-type="${type.id}">
                <span class="tool-type-icon" style="color: ${type.color}">${type.icon}</span>
                <div class="tool-type-name">${type.name}</div>
                <div class="tool-type-count" id="count-${type.id}">0 Ø£Ø¯Ø§Ø©</div>
            </div>
        `;
    });
    
    // Add custom types from database
    db.collection('toolTypes').where('isCustom', '==', true).get().then(snapshot => {
        snapshot.forEach(doc => {
            const customType = doc.data();
            html += `
                <div class="tool-type-card" onclick="filterByType('${doc.id}')" data-type="${doc.id}">
                    <span class="tool-type-icon">${customType.icon || 'ğŸ“¦'}</span>
                    <div class="tool-type-name">${customType.name}</div>
                    <div class="tool-type-count" id="count-${doc.id}">0 Ø£Ø¯Ø§Ø©</div>
                </div>
            `;
        });
        
        // Add "create type" card
        html += `
            <div class="tool-type-card add-type-card" onclick="createNewType()">
                <span class="tool-type-icon">â•</span>
                <div class="tool-type-name">Ø¥Ø¶Ø§ÙØ© Ù†ÙˆØ¹</div>
            </div>
        `;
        
        container.innerHTML = html;
        updateTypeCounts();
    });
}

// Load tools
async function loadTools() {
    showLoading(true);
    
    try {
        const snapshot = await db.collection('toolsLibrary')
            .orderBy('basicInfo.createdDate', 'desc')
            .get();
        
        allTools = [];
        
        snapshot.forEach(doc => {
            allTools.push({
                id: doc.id,
                ...doc.data()
            });
        });
        
        updateStats();
        filterTools();
        
    } catch (error) {
        console.error('Error loading tools:', error);
        showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª', 'error');
    } finally {
        showLoading(false);
    }
}

// Update statistics
function updateStats() {
    // Total tools
    document.getElementById('totalToolsCount').textContent = allTools.length;
    
    // Active usage count
    let activeUsage = 0;
    let totalRating = 0;
    let ratedTools = 0;
    let totalCompletions = 0;
    let totalAssignments = 0;
    
    allTools.forEach(tool => {
        const analytics = tool.tracking?.analytics || {};
        activeUsage += analytics.timesUsed || 0;
        
        if (analytics.averageRating) {
            totalRating += analytics.averageRating;
            ratedTools++;
        }
        
        if (analytics.successRate) {
            totalCompletions += analytics.successRate;
            totalAssignments++;
        }
    });
    
    document.getElementById('activeUsageCount').textContent = activeUsage;
    document.getElementById('avgRating').textContent = ratedTools > 0 ? 
        (totalRating / ratedTools).toFixed(1) : '0';
    document.getElementById('completionRate').textContent = totalAssignments > 0 ? 
        Math.round(totalCompletions / totalAssignments) + '%' : '0%';
}

// Update type counts
function updateTypeCounts() {
    const counts = {};
    
    allTools.forEach(tool => {
        const type = tool.basicInfo?.type || 'unknown';
        counts[type] = (counts[type] || 0) + 1;
    });
    
    Object.keys(counts).forEach(type => {
        const element = document.getElementById(`count-${type}`);
        if (element) {
            element.textContent = counts[type] + ' Ø£Ø¯Ø§Ø©';
        }
    });
}

// Filter by type
function filterByType(type) {
    // Update UI
    document.querySelectorAll('.tool-type-card').forEach(card => {
        card.classList.remove('active');
    });
    
    document.querySelector(`[data-type="${type}"]`)?.classList.add('active');
    
    // Filter tools
    if (type === currentFilter) {
        // If clicking same type, reset filter
        currentFilter = 'all';
        document.querySelector(`[data-type="${type}"]`)?.classList.remove('active');
    } else {
        currentFilter = type;
    }
    
    filterTools();
}

// Filter by program
function filterByProgram(program) {
    // Update UI
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    event.target.classList.add('active');
    
    // Set filter
    currentFilter = program;
    filterTools();
}

// Filter tools
function filterTools() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    
    filteredTools = allTools.filter(tool => {
        // Search filter
        if (searchTerm) {
            const searchableText = [
                tool.basicInfo?.name,
                tool.basicInfo?.description,
                tool.basicInfo?.type
            ].join(' ').toLowerCase();
            
            if (!searchableText.includes(searchTerm)) {
                return false;
            }
        }
        
        // Type/Program filter
        if (currentFilter !== 'all') {
            // Check if it's a type filter
            if (tool.basicInfo?.type === currentFilter) {
                return true;
            }
            
            // Check if it's a program filter
            const targetPrograms = tool.settings?.targetPrograms || [];
            if (targetPrograms.includes(currentFilter) || targetPrograms.includes('all')) {
                return true;
            }
            
            return false;
        }
        
        return true;
    });
    
    displayTools();
}

// Display tools
function displayTools() {
    const container = document.getElementById('toolsGrid');
    const emptyState = document.getElementById('emptyState');
    
    if (filteredTools.length === 0) {
        container.style.display = 'none';
        emptyState.style.display = 'block';
        return;
    }
    
    container.style.display = currentView === 'grid' ? 'grid' : 'block';
    emptyState.style.display = 'none';
    
    let html = '';
    
    filteredTools.forEach(tool => {
        const type = toolTypes.find(t => t.id === tool.basicInfo?.type);
        const typeColor = type?.color || '#666';
        const typeIcon = type?.icon || 'ğŸ“¦';
        const analytics = tool.tracking?.analytics || {};
        
        html += `
            <div class="tool-card">
                <div class="tool-card-header">
                    <div class="tool-card-title">
                        <h3 class="tool-name">${tool.basicInfo?.name || 'Ø£Ø¯Ø§Ø© ØºÙŠØ± Ù…Ø³Ù…Ø§Ø©'}</h3>
                        <span class="tool-type-badge tool-type-${tool.basicInfo?.type}">
                            ${typeIcon} ${type?.name || tool.basicInfo?.type}
                        </span>
                    </div>
                    <p class="tool-description">${tool.basicInfo?.description || ''}</p>
                </div>
                
                <div class="tool-card-body">
                    <div class="tool-meta">
                        <div class="meta-item">
                            <span class="meta-label">Ø§Ù„Ù…Ø¯Ø©</span>
                            <span class="meta-value">${tool.settings?.defaultDuration || 15} Ø¯</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Ø§Ù„ØªÙƒØ±Ø§Ø±</span>
                            <span class="meta-value">${getFrequencyName(tool.settings?.frequency)}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬</span>
                            <span class="meta-value">${getProgramsDisplay(tool.settings?.targetPrograms)}</span>
                        </div>
                    </div>
                    
                    <div class="tool-stats">
                        <div class="stat-item">
                            <span class="stat-value">${analytics.timesUsed || 0}</span>
                            <span class="stat-label">Ù…Ø±Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù…</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">${analytics.averageRating || 0}â­</span>
                            <span class="stat-label">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">${analytics.successRate || 0}%</span>
                            <span class="stat-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­</span>
                        </div>
                    </div>
                    
                    <div class="tool-actions">
                        <button class="btn btn-primary" onclick="editTool('${tool.id}')">
                            <span>âœï¸</span> ØªØ¹Ø¯ÙŠÙ„
                        </button>
                        <button class="btn btn-secondary" onclick="duplicateTool('${tool.id}')">
                            <span>ğŸ“‹</span> Ù†Ø³Ø®
                        </button>
                        <button class="btn btn-icon" onclick="viewToolStats('${tool.id}')">
                            <span>ğŸ“Š</span>
                        </button>
                        <button class="btn btn-icon" onclick="deleteTool('${tool.id}')" style="color: var(--danger);">
                            <span>ğŸ—‘ï¸</span>
                        </button>
                    </div>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

// Switch view
function switchView(view) {
    currentView = view;
    
    document.querySelectorAll('.view-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    event.target.classList.add('active');
    
    displayTools();
}

// Open tool creator
function openToolCreator() {
    resetForm();
    document.getElementById('toolCreatorModal').style.display = 'block';
}

// Close tool creator
function closeToolCreator() {
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©ØŸ Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©.')) {
        document.getElementById('toolCreatorModal').style.display = 'none';
        resetForm();
    }
}

// Reset form
function resetForm() {
    currentStep = 1;
    selectedMeasurement = null;
    selectedChannels = ['whatsapp'];
    
    // Clear all form fields
    document.querySelectorAll('input[type="text"], input[type="number"], textarea, select').forEach(field => {
        field.value = '';
    });
    
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = false;
    });
    
    // Reset steps UI
    updateStepsUI();
}

// Update steps UI
function updateStepsUI() {
    // Update step indicators
    for (let i = 1; i <= 4; i++) {
        const step = document.getElementById(`step${i}`);
        const section = document.getElementById(`section${i}`);
        
        step.classList.remove('active', 'completed');
        section.classList.remove('active');
        
        if (i < currentStep) {
            step.classList.add('completed');
        } else if (i === currentStep) {
            step.classList.add('active');
            section.classList.add('active');
        }
    }
    
    // Update buttons
    document.getElementById('prevBtn').style.display = currentStep > 1 ? 'block' : 'none';
    document.getElementById('nextBtn').style.display = currentStep < 4 ? 'block' : 'none';
    document.getElementById('saveBtn').style.display = currentStep === 4 ? 'block' : 'none';
    
    // Load type specific content if on step 2
    if (currentStep === 2) {
        loadTypeSpecificContent();
    }
    
    // Generate preview if on step 4
    if (currentStep === 4) {
        generatePreview();
    }
}

// Next step
function nextStep() {
    if (validateCurrentStep()) {
        currentStep++;
        updateStepsUI();
    }
}

// Previous step
function previousStep() {
    currentStep--;
    updateStepsUI();
}

// Validate current step
function validateCurrentStep() {
    switch (currentStep) {
        case 1:
            const name = document.getElementById('toolName').value.trim();
            const type = document.getElementById('toolType').value;
            const description = document.getElementById('toolDescription').value.trim();
            
            if (!name) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©', 'error');
                return false;
            }
            
            if (!type) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø£Ø¯Ø§Ø©', 'error');
                return false;
            }
            
            if (!description) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ø£Ø¯Ø§Ø©', 'error');
                return false;
            }
            
            return true;
            
        case 2:
            // Validate based on tool type
            return validateTypeSpecificContent();
            
        case 3:
            if (!selectedMeasurement) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³', 'error');
                return false;
            }
            return true;
            
        default:
            return true;
    }
}

// Update type specific fields
function updateTypeSpecificFields() {
    const type = document.getElementById('toolType').value;
    const customGroup = document.getElementById('customTypeGroup');
    
    if (type === 'custom') {
        customGroup.style.display = 'block';
    } else {
        customGroup.style.display = 'none';
    }
}

// Load type specific content
function loadTypeSpecificContent() {
    const type = document.getElementById('toolType').value;
    const container = document.getElementById('typeSpecificContent');
    
    let html = '';
    
    switch (type) {
        case 'practice':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø©</h4>
                    
                    <div class="form-group">
                        <label>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø©</label>
                        <textarea id="practiceInstructions" rows="5" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ù…Ù…Ø§Ø±Ø³Ø©..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                        <div class="steps-builder" id="practiceSteps">
                            <div class="step-item">
                                <div class="step-header">
                                    <span class="step-handle">â˜°</span>
                                    <h5>Ø§Ù„Ø®Ø·ÙˆØ© 1</h5>
                                    <span class="remove-step" onclick="removeStep(this)">âŒ</span>
                                </div>
                                <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·ÙˆØ©" class="step-title-input">
                                <textarea placeholder="ÙˆØµÙ Ø§Ù„Ø®Ø·ÙˆØ©" rows="2" class="step-description"></textarea>
                                <input type="number" placeholder="Ø§Ù„Ù…Ø¯Ø© (Ø¯Ù‚Ø§Ø¦Ù‚)" value="5" min="1" class="step-duration">
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addPracticeStep()">+ Ø¥Ø¶Ø§ÙØ© Ø®Ø·ÙˆØ©</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ù†Ø¬Ø§Ø­</label>
                        <textarea id="practiceTips" rows="3" placeholder="Ù†ØµØ§Ø¦Ø­ ØªØ³Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¬Ø§Ø­..."></textarea>
                    </div>
                </div>
            `;
            break;
            
        case 'meditation':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ£Ù…Ù„</h4>
                    
                    <div class="form-group">
                        <label>Ù†Øµ Ø§Ù„ØªØ£Ù…Ù„</label>
                        <textarea id="meditationScript" rows="10" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„ØªØ£Ù…Ù„ Ø§Ù„Ù…ÙˆØ¬Ù‡..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…Ù„Ù ØµÙˆØªÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="file" id="meditationAudio" accept="audio/*">
                        <small style="color: #666;">ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ù…Ù„Ù ØµÙˆØªÙŠ Ù„Ù„ØªØ£Ù…Ù„</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø®Ù„ÙÙŠØ©</label>
                        <select id="backgroundMusic">
                            <option value="none">Ø¨Ø¯ÙˆÙ† Ù…ÙˆØ³ÙŠÙ‚Ù‰</option>
                            <option value="nature">Ø£ØµÙˆØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©</option>
                            <option value="calm">Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù‡Ø§Ø¯Ø¦Ø©</option>
                            <option value="binaural">Ù†ØºÙ…Ø§Øª Ø«Ù†Ø§Ø¦ÙŠØ©</option>
                            <option value="custom">Ø±ÙØ¹ Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù…Ø®ØµØµØ©</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="customMusicGroup" style="display: none;">
                        <label>Ø±ÙØ¹ Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù…Ø®ØµØµØ©</label>
                        <input type="file" id="customMusic" accept="audio/*">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„ØªØ£Ù…Ù„</label>
                        <textarea id="preMeditationGuide" rows="3" placeholder="ØªØ­Ø¶ÙŠØ±Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡..."></textarea>
                    </div>
                </div>
            `;
            break;
            
        case 'game':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù„Ø¹Ø¨Ø©</h4>
                    
                    <div class="form-group">
                        <label>Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©</label>
                        <textarea id="gameRules" rows="5" placeholder="Ø§Ø´Ø±Ø­ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨ÙˆØ¶ÙˆØ­..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©</label>
                        <div id="gameObjectives">
                            <div style="margin-bottom: 0.5rem;">
                                <input type="text" placeholder="Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£ÙˆÙ„" style="width: calc(100% - 40px);">
                                <button onclick="removeObjective(this)" style="width: 30px;">âŒ</button>
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addObjective()">+ Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ø§Ø·</label>
                        <textarea id="scoringSystem" rows="3" placeholder="ÙƒÙŠÙ ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·ØŸ"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <div id="gameLevels">
                            <div class="step-item">
                                <h5>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</h5>
                                <input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰" class="level-name">
                                <textarea placeholder="Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰" rows="2" class="level-requirements"></textarea>
                                <input type="text" placeholder="Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª" class="level-rewards">
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addGameLevel()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙˆÙ‰</button>
                    </div>
                </div>
            `;
            break;
            
        case 'challenge':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ­Ø¯ÙŠ</h4>
                    
                    <div class="form-group">
                        <label>ÙˆØµÙ Ø§Ù„ØªØ­Ø¯ÙŠ</label>
                        <textarea id="challengeDescription" rows="5" placeholder="Ø§Ø´Ø±Ø­ Ø§Ù„ØªØ­Ø¯ÙŠ Ø¨Ø§Ù„ØªÙØµÙŠÙ„..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…)</label>
                        <input type="number" id="challengeDuration" value="7" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ­Ø¯ÙŠ</label>
                        <div id="challengeMilestones">
                            <div class="step-item">
                                <div class="step-header">
                                    <span>Ø§Ù„ÙŠÙˆÙ… 1</span>
                                    <span class="remove-step" onclick="removeMilestone(this)">âŒ</span>
                                </div>
                                <input type="text" placeholder="Ù…Ù‡Ù…Ø© Ø§Ù„ÙŠÙˆÙ…" class="milestone-task">
                                <select class="milestone-verification">
                                    <option value="checkbox">Ù…Ø±Ø¨Ø¹ Ø§Ø®ØªÙŠØ§Ø±</option>
                                    <option value="photo">ØµÙˆØ±Ø©</option>
                                    <option value="text">Ù†Øµ</option>
                                </select>
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addMilestone()">+ Ø¥Ø¶Ø§ÙØ© ÙŠÙˆÙ…</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</label>
                        <textarea id="challengeRewards" rows="3" placeholder="Ù…Ø§Ø°Ø§ ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† ÙŠÙ†Ø¬Ø­ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØŸ"></textarea>
                    </div>
                </div>
            `;
            break;
            
        case 'reflection':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ£Ù…Ù„ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ</h4>
                    
                    <div class="form-group">
                        <label>Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„ØªØ£Ù…Ù„</label>
                        <textarea id="reflectionIntro" rows="3" placeholder="Ù…Ù‚Ø¯Ù…Ø© ØªØ­ÙØ² Ø¹Ù„Ù‰ Ø§Ù„ØªØ£Ù…Ù„..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªØ£Ù…Ù„</label>
                        <div id="reflectionQuestions">
                            <div style="margin-bottom: 0.5rem;">
                                <input type="text" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„" style="width: calc(100% - 40px);">
                                <button onclick="removeReflectionQuestion(this)" style="width: 30px;">âŒ</button>
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addReflectionQuestion()">+ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©</label>
                        <textarea id="writingGuidelines" rows="3" placeholder="Ù†ØµØ§Ø¦Ø­ Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙØ¹Ø§Ù„Ø©..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ÙƒÙ„Ù…Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="number" id="minWords" placeholder="Ù…Ø«Ø§Ù„: 100" min="0">
                    </div>
                </div>
            `;
            break;
            
        case 'voice':
            html = `
                <div class="type-specific-content">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØµÙˆØªÙŠ</h4>
                    
                    <div class="form-group">
                        <label>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ†</label>
                        <textarea id="voiceInstructions" rows="5" placeholder="Ø§Ø´Ø±Ø­ ÙƒÙŠÙÙŠØ© Ø£Ø¯Ø§Ø¡ Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØµÙˆØªÙŠ..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ)</label>
                        <input type="number" id="recordingDuration" value="60" min="10">
                    </div>
                    
                    <div class="form-group">
                        <label>Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ù…Ù‚ØªØ±Ø­Ø©</label>
                        <div id="voiceTopics">
                            <div style="margin-bottom: 0.5rem;">
                                <input type="text" placeholder="Ù…ÙˆØ¶ÙˆØ¹ Ù„Ù„Ø­Ø¯ÙŠØ« Ø¹Ù†Ù‡" style="width: calc(100% - 40px);">
                                <button onclick="removeVoiceTopic(this)" style="width: 30px;">âŒ</button>
                            </div>
                        </div>
                        <button class="add-step-btn" onclick="addVoiceTopic()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¶ÙˆØ¹</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Ø£Ø³Ø¦Ù„Ø© ØªÙˆØ¬ÙŠÙ‡ÙŠØ©</label>
                        <textarea id="guidingQuestions" rows="3" placeholder="Ø£Ø³Ø¦Ù„Ø© ØªØ³Ø§Ø¹Ø¯ ÙÙŠ ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„..."></textarea>
                    </div>
                </div>
            `;
            break;
    }
    
    container.innerHTML = html;
    
    // Add event listeners for dynamic elements
    if (type === 'meditation') {
        document.getElementById('backgroundMusic').addEventListener('change', function() {
            document.getElementById('customMusicGroup').style.display = 
                this.value === 'custom' ? 'block' : 'none';
        });
    }
}

// Validate type specific content
function validateTypeSpecificContent() {
    const type = document.getElementById('toolType').value;
    
    switch (type) {
        case 'practice':
            const instructions = document.getElementById('practiceInstructions').value.trim();
            if (!instructions) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø©', 'error');
                return false;
            }
            return true;
            
        case 'meditation':
            const script = document.getElementById('meditationScript').value.trim();
            if (!script) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„ØªØ£Ù…Ù„', 'error');
                return false;
            }
            return true;
            
        case 'game':
            const rules = document.getElementById('gameRules').value.trim();
            if (!rules) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø©', 'error');
                return false;
            }
            return true;
            
        case 'challenge':
            const description = document.getElementById('challengeDescription').value.trim();
            if (!description) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„ØªØ­Ø¯ÙŠ', 'error');
                return false;
            }
            return true;
            
        case 'reflection':
            const questions = document.querySelectorAll('#reflectionQuestions input[type="text"]');
            if (questions.length === 0 || !questions[0].value.trim()) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¶Ù Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                return false;
            }
            return true;
            
        case 'voice':
            const voiceInstructions = document.getElementById('voiceInstructions').value.trim();
            if (!voiceInstructions) {
                showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ†', 'error');
                return false;
            }
            return true;
            
        default:
            return true;
    }
}

// Add practice step
function addPracticeStep() {
    const container = document.getElementById('practiceSteps');
    const stepCount = container.querySelectorAll('.step-item').length + 1;
    
    const stepHtml = `
        <div class="step-item">
            <div class="step-header">
                <span class="step-handle">â˜°</span>
                <h5>Ø§Ù„Ø®Ø·ÙˆØ© ${stepCount}</h5>
                <span class="remove-step" onclick="removeStep(this)">âŒ</span>
            </div>
            <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·ÙˆØ©" class="step-title-input">
            <textarea placeholder="ÙˆØµÙ Ø§Ù„Ø®Ø·ÙˆØ©" rows="2" class="step-description"></textarea>
            <input type="number" placeholder="Ø§Ù„Ù…Ø¯Ø© (Ø¯Ù‚Ø§Ø¦Ù‚)" value="5" min="1" class="step-duration">
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', stepHtml);
}

// Remove step
function removeStep(button) {
    button.closest('.step-item').remove();
    updateStepNumbers();
}

// Update step numbers
function updateStepNumbers() {
    const steps = document.querySelectorAll('#practiceSteps .step-item');
    steps.forEach((step, index) => {
        step.querySelector('h5').textContent = `Ø§Ù„Ø®Ø·ÙˆØ© ${index + 1}`;
    });
}

// Select measurement
function selectMeasurement(type) {
    selectedMeasurement = type;
    
    document.querySelectorAll('.measurement-option').forEach(option => {
        option.classList.remove('selected');
    });
    
    event.target.closest('.measurement-option').classList.add('selected');
}

// Add question
function addQuestion() {
    const container = document.getElementById('questionsBuilder');
    
    const questionHtml = `
        <div class="question-item">
            <input type="text" class="question-input" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„">
            <select class="question-type">
                <option value="text">Ù†Øµ</option>
                <option value="scale">Ù…Ù‚ÙŠØ§Ø³</option>
                <option value="choice">Ø§Ø®ØªÙŠØ§Ø±</option>
            </select>
            <span class="remove-question" onclick="removeQuestion(this)">âŒ</span>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', questionHtml);
}

// Remove question
function removeQuestion(button) {
    button.closest('.question-item').remove();
}

// Toggle reminders
function toggleReminders() {
    const enabled = document.getElementById('enableReminders').checked;
    document.getElementById('reminderSetup').style.display = enabled ? 'block' : 'none';
}

// Toggle channel
function toggleChannel(element, channel) {
    element.classList.toggle('selected');
    
    if (element.classList.contains('selected')) {
        if (!selectedChannels.includes(channel)) {
            selectedChannels.push(channel);
        }
    } else {
        selectedChannels = selectedChannels.filter(c => c !== channel);
    }
}

// Toggle all programs
function toggleAllPrograms() {
    const allChecked = document.getElementById('targetAll').checked;
    
    document.querySelectorAll('.program-check').forEach(checkbox => {
        checkbox.checked = allChecked;
        checkbox.disabled = allChecked;
    });
}

// Generate preview
function generatePreview() {
    const name = document.getElementById('toolName').value;
    const type = document.getElementById('toolType').value;
    const description = document.getElementById('toolDescription').value;
    const duration = document.getElementById('defaultDuration').value;
    const frequency = document.getElementById('defaultFrequency').value;
    
    const preview = document.getElementById('toolPreview');
    
    const typeInfo = toolTypes.find(t => t.id === type);
    
    let previewHtml = `
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 1rem;">
            <h3 style="color: var(--primary); margin-bottom: 0.5rem;">
                ${typeInfo?.icon || 'ğŸ“¦'} ${name}
            </h3>
            <p style="color: #666; margin-bottom: 1rem;">${description}</p>
            
            <div style="display: flex; gap: 2rem; margin-bottom: 1rem;">
                <div>
                    <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${typeInfo?.name || type}
                </div>
                <div>
                    <strong>Ø§Ù„Ù…Ø¯Ø©:</strong> ${duration} Ø¯Ù‚ÙŠÙ‚Ø©
                </div>
                <div>
                    <strong>Ø§Ù„ØªÙƒØ±Ø§Ø±:</strong> ${getFrequencyName(frequency)}
                </div>
            </div>
        </div>
    `;
    
    // Add type-specific preview
    switch (type) {
        case 'practice':
            const steps = document.querySelectorAll('#practiceSteps .step-item');
            if (steps.length > 0) {
                previewHtml += '<h4>Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ†ÙÙŠØ°:</h4><ol>';
                steps.forEach(step => {
                    const title = step.querySelector('.step-title-input').value;
                    const desc = step.querySelector('.step-description').value;
                    if (title) {
                        previewHtml += `<li><strong>${title}</strong><br>${desc}</li>`;
                    }
                });
                previewHtml += '</ol>';
            }
            break;
            
        case 'challenge':
            const challengeDuration = document.getElementById('challengeDuration').value;
            previewHtml += `<p><strong>Ù…Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ:</strong> ${challengeDuration} Ø£ÙŠØ§Ù…</p>`;
            break;
    }
    
    // Add tracking info
    if (selectedMeasurement) {
        previewHtml += `
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #ddd;">
                <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³:</strong> ${getMeasurementName(selectedMeasurement)}
            </div>
        `;
    }
    
    // Add automation info
    if (document.getElementById('enableReminders').checked) {
        const time = document.getElementById('reminderTime').value;
        previewHtml += `
            <div style="margin-top: 0.5rem;">
                <strong>Ø§Ù„ØªØ°ÙƒÙŠØ±:</strong> ${time} Ø¹Ø¨Ø± ${selectedChannels.join(', ')}
            </div>
        `;
    }
    
    preview.innerHTML = previewHtml;
}

// Refresh preview
function refreshPreview() {
    generatePreview();
}

// Save tool
async function saveTool() {
    if (!validateAllSteps()) {
        return;
    }
    
    showLoading(true);
    
    try {
        // Collect all data
        const toolData = {
            basicInfo: {
                name: document.getElementById('toolName').value.trim(),
                type: document.getElementById('toolType').value,
                description: document.getElementById('toolDescription').value.trim(),
                creator: auth.currentUser?.uid || 'admin',
                createdDate: firebase.firestore.FieldValue.serverTimestamp(),
                lastModified: firebase.firestore.FieldValue.serverTimestamp(),
                version: 1
            },
            
            settings: {
                defaultDuration: parseInt(document.getElementById('defaultDuration').value) || 15,
                frequency: document.getElementById('defaultFrequency').value,
                targetPrograms: getSelectedPrograms(),
                targetPhases: [] // Will be set based on program
            },
            
            content: getToolContent(),
            
            tracking: {
                measurementType: selectedMeasurement,
                successCriteria: document.getElementById('successCriteria').value.trim(),
                feedbackQuestions: getQuestions(),
                analytics: {
                    timesUsed: 0,
                    averageCompletion: 0,
                    averageRating: 0,
                    successRate: 0
                }
            },
            
            automation: getAutomationSettings()
        };
        
        // Save to Firestore
        const docRef = await db.collection('toolsLibrary').add(toolData);
        
        showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        
        // Close modal and reload
        document.getElementById('toolCreatorModal').style.display = 'none';
        resetForm();
        loadTools();
        
    } catch (error) {
        console.error('Error saving tool:', error);
        showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø£Ø¯Ø§Ø©: ' + error.message, 'error');
    } finally {
        showLoading(false);
    }
}

// Validate all steps
function validateAllSteps() {
    const currentStepBackup = currentStep;
    
    for (let i = 1; i <= 3; i++) {
        currentStep = i;
        if (!validateCurrentStep()) {
            updateStepsUI();
            return false;
        }
    }
    
    currentStep = currentStepBackup;
    return true;
}

// Get selected programs
function getSelectedPrograms() {
    if (document.getElementById('targetAll').checked) {
        return ['all'];
    }
    
    const programs = [];
    if (document.getElementById('targetClarity').checked) programs.push('clarity');
    if (document.getElementById('targetDiscovery').checked) programs.push('discovery');
    if (document.getElementById('targetTransformation').checked) programs.push('transformation');
    
    return programs.length > 0 ? programs : ['all'];
}

// Get tool content
function getToolContent() {
    const type = document.getElementById('toolType').value;
    const content = {};
    
    switch (type) {
        case 'practice':
            const steps = [];
            document.querySelectorAll('#practiceSteps .step-item').forEach((step, index) => {
                steps.push({
                    order: index + 1,
                    title: step.querySelector('.step-title-input').value,
                    description: step.querySelector('.step-description').value,
                    duration: parseInt(step.querySelector('.step-duration').value) || 5
                });
            });
            
            content.instructions = {
                text: document.getElementById('practiceInstructions').value,
                steps: steps
            };
            content.tips = document.getElementById('practiceTips').value;
            break;
            
        case 'meditation':
            content.meditation = {
                script: document.getElementById('meditationScript').value,
                audioUrl: '', // Handle file upload separately
                backgroundMusic: document.getElementById('backgroundMusic').value,
                guidedBy: 'Ø§Ù„ÙƒÙˆØªØ´'
            };
            content.preMeditationGuide = document.getElementById('preMeditationGuide').value;
            break;
            
        case 'game':
            const objectives = [];
            document.querySelectorAll('#gameObjectives input').forEach(input => {
                if (input.value.trim()) {
                    objectives.push(input.value.trim());
                }
            });
            
            const levels = [];
            document.querySelectorAll('#gameLevels .step-item').forEach((level, index) => {
                levels.push({
                    level: index + 1,
                    name: level.querySelector('.level-name').value,
                    requirements: level.querySelector('.level-requirements').value,
                    rewards: level.querySelector('.level-rewards').value
                });
            });
            
            content.game = {
                rules: document.getElementById('gameRules').value,
                objectives: objectives,
                scoringSystem: document.getElementById('scoringSystem').value,
                levels: levels
            };
            break;
            
        case 'challenge':
            const milestones = [];
            document.querySelectorAll('#challengeMilestones .step-item').forEach((milestone, index) => {
                milestones.push({
                    day: index + 1,
                    task: milestone.querySelector('.milestone-task').value,
                    verification: milestone.querySelector('.milestone-verification').value
                });
            });
            
            content.challenge = {
                description: document.getElementById('challengeDescription').value,
                duration: parseInt(document.getElementById('challengeDuration').value),
                milestones: milestones,
                rewards: document.getElementById('challengeRewards').value
            };
            break;
            
        case 'reflection':
            const questions = [];
            document.querySelectorAll('#reflectionQuestions input').forEach(input => {
                if (input.value.trim()) {
                    questions.push(input.value.trim());
                }
            });
            
            content.reflection = {
                intro: document.getElementById('reflectionIntro').value,
                questions: questions,
                guidelines: document.getElementById('writingGuidelines').value,
                minWords: parseInt(document.getElementById('minWords').value) || 0
            };
            break;
            
        case 'voice':
            const topics = [];
            document.querySelectorAll('#voiceTopics input').forEach(input => {
                if (input.value.trim()) {
                    topics.push(input.value.trim());
                }
            });
            
            content.voice = {
                instructions: document.getElementById('voiceInstructions').value,
                recordingDuration: parseInt(document.getElementById('recordingDuration').value),
                suggestedTopics: topics,
                guidingQuestions: document.getElementById('guidingQuestions').value
            };
            break;
    }
    
    return content;
}

// Get questions
function getQuestions() {
    const questions = [];
    
    document.querySelectorAll('#questionsBuilder .question-item').forEach(item => {
        const question = item.querySelector('.question-input').value.trim();
        const type = item.querySelector('.question-type').value;
        
        if (question) {
            questions.push({
                question: question,
                type: type,
                required: true
            });
        }
    });
    
    return questions;
}

// Get automation settings
function getAutomationSettings() {
    const automation = {
        reminders: {
            enabled: document.getElementById('enableReminders').checked,
            timing: 'atTime',
            message: document.getElementById('reminderMessage')?.value || '',
            channel: selectedChannels.join(',')
        },
        
        messages: {
            onAssign: document.getElementById('msgOnAssign').value,
            onComplete: document.getElementById('msgOnComplete').value,
            onSkip: document.getElementById('msgOnSkip').value
        }
    };
    
    if (automation.reminders.enabled) {
        automation.reminders.time = document.getElementById('reminderTime').value;
        automation.reminders.timing = document.getElementById('reminderTiming').value;
        
        if (automation.reminders.timing !== 'exact') {
            automation.reminders.offset = parseInt(document.getElementById('reminderOffset').value);
        }
    }
    
    return automation;
}

// Edit tool
async function editTool(toolId) {
    // Load tool data and populate form
    showNotification('Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±', 'info');
}

// Duplicate tool
async function duplicateTool(toolId) {
    if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©ØŸ')) return;
    
    showLoading(true);
    
    try {
        // Get original tool
        const doc = await db.collection('toolsLibrary').doc(toolId).get();
        if (!doc.exists) {
            throw new Error('Ø§Ù„Ø£Ø¯Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
        }
        
        const toolData = doc.data();
        
        // Create copy
        const copyData = {
            ...toolData,
            basicInfo: {
                ...toolData.basicInfo,
                name: toolData.basicInfo.name + ' (Ù†Ø³Ø®Ø©)',
                createdDate: firebase.firestore.FieldValue.serverTimestamp(),
                lastModified: firebase.firestore.FieldValue.serverTimestamp()
            },
            tracking: {
                ...toolData.tracking,
                analytics: {
                    timesUsed: 0,
                    averageCompletion: 0,
                    averageRating: 0,
                    successRate: 0
                }
            }
        };
        
        await db.collection('toolsLibrary').add(copyData);
        
        showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        loadTools();
        
    } catch (error) {
        console.error('Error duplicating tool:', error);
        showNotification('Ø®Ø·Ø£ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø£Ø¯Ø§Ø©', 'error');
    } finally {
        showLoading(false);
    }
}

// View tool stats
function viewToolStats(toolId) {
    showNotification('ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±', 'info');
}

// Delete tool
async function deleteTool(toolId) {
    if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) return;
    
    showLoading(true);
    
    try {
        await db.collection('toolsLibrary').doc(toolId).delete();
        
        showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        loadTools();
        
    } catch (error) {
        console.error('Error deleting tool:', error);
        showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø©', 'error');
    } finally {
        showLoading(false);
    }
}

// Create new type
async function createNewType() {
    const name = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯:');
    if (!name) return;
    
    const icon = prompt('Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù†ÙˆØ¹ (emoji):', 'ğŸ“¦');
    if (!icon) return;
    
    try {
        await db.collection('toolTypes').add({
            name: name,
            icon: icon,
            isCustom: true,
            createdDate: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'success');
        loadToolTypes();
        
    } catch (error) {
        console.error('Error creating type:', error);
        showNotification('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹', 'error');
    }
}

// Helper functions for dynamic content
function addObjective() {
    const container = document.getElementById('gameObjectives');
    const html = `
        <div style="margin-bottom: 0.5rem;">
            <input type="text" placeholder="Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯" style="width: calc(100% - 40px);">
            <button onclick="removeObjective(this)" style="width: 30px;">âŒ</button>
        </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
}

function removeObjective(button) {
    button.parentElement.remove();
}

function addGameLevel() {
    const container = document.getElementById('gameLevels');
    const levelCount = container.querySelectorAll('.step-item').length + 1;
    
    const html = `
        <div class="step-item">
            <h5>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${levelCount}</h5>
            <input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰" class="level-name">
            <textarea placeholder="Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰" rows="2" class="level-requirements"></textarea>
            <input type="text" placeholder="Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª" class="level-rewards">
        </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
}

function addMilestone() {
    const container = document.getElementById('challengeMilestones');
    const dayCount = container.querySelectorAll('.step-item').length + 1;
    
    const html = `
        <div class="step-item">
            <div class="step-header">
                <span>Ø§Ù„ÙŠÙˆÙ… ${dayCount}</span>
                <span class="remove-step" onclick="removeMilestone(this)">âŒ</span>
            </div>
            <input type="text" placeholder="Ù…Ù‡Ù…Ø© Ø§Ù„ÙŠÙˆÙ…" class="milestone-task">
            <select class="milestone-verification">
                <option value="checkbox">Ù…Ø±Ø¨Ø¹ Ø§Ø®ØªÙŠØ§Ø±</option>
                <option value="photo">ØµÙˆØ±Ø©</option>
                <option value="text">Ù†Øµ</option>
            </select>
        </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
}

function removeMilestone(button) {
    button.closest('.step-item').remove();
    // Update day numbers
    const milestones = document.querySelectorAll('#challengeMilestones .step-item');
    milestones.forEach((milestone, index) => {
        milestone.querySelector('.step-header span:first-child').textContent = `Ø§Ù„ÙŠÙˆÙ… ${index + 1}`;
    });
}

function addReflectionQuestion() {
    const container = document.getElementById('reflectionQuestions');
    const html = `
        <div style="margin-bottom: 0.5rem;">
            <input type="text" placeholder="Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯" style="width: calc(100% - 40px);">
            <button onclick="removeReflectionQuestion(this)" style="width: 30px;">âŒ</button>
        </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
}

function removeReflectionQuestion(button) {
    button.parentElement.remove();
}

function addVoiceTopic() {
    const container = document.getElementById('voiceTopics');
    const html = `
        <div style="margin-bottom: 0.5rem;">
            <input type="text" placeholder="Ù…ÙˆØ¶ÙˆØ¹ Ù„Ù„Ø­Ø¯ÙŠØ« Ø¹Ù†Ù‡" style="width: calc(100% - 40px);">
            <button onclick="removeVoiceTopic(this)" style="width: 30px;">âŒ</button>
        </div>
    `;
    container.insertAdjacentHTML('beforeend', html);
}

function removeVoiceTopic(button) {
    button.parentElement.remove();
}

// Helper functions
function getFrequencyName(frequency) {
    const names = {
        daily: 'ÙŠÙˆÙ…ÙŠØ§Ù‹',
        every2days: 'ÙƒÙ„ ÙŠÙˆÙ…ÙŠÙ†',
        weekly: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹',
        asneeded: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©'
    };
    return names[frequency] || frequency;
}

function getProgramsDisplay(programs) {
    if (!programs || programs.length === 0 || programs.includes('all')) {
        return 'Ø§Ù„ÙƒÙ„';
    }
    
    const names = {
        clarity: 'ÙˆØ¶ÙˆØ­',
        discovery: 'Ø§ÙƒØªØ´Ø§Ù',
        transformation: 'ØªØ­ÙˆÙ„'
    };
    
    return programs.map(p => names[p] || p).join(', ');
}

function getMeasurementName(type) {
    const names = {
        binary: 'ØªÙ… / Ù„Ù… ÙŠØªÙ…',
        scale: 'Ù…Ù‚ÙŠØ§Ø³ (1-10)',
        duration: 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©',
        quality: 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡',
        text: 'Ù†Øµ Ù…ÙØªÙˆØ­'
    };
    return names[type] || type;
}

function showLoading(show) {
    document.getElementById('loadingOverlay').style.display = show ? 'flex' : 'none';
}

function showNotification(message, type = 'success') {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    const icon = {
        success: 'âœ“',
        error: 'âœ—',
        info: 'â„¹',
        warning: 'âš '
    };
    
    notification.innerHTML = `
        <span>${icon[type] || icon.info}</span>
        <span>${message}</span>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = '1';
        notification.style.transform = 'translateX(0)';
    }, 10);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
    
    notification.onclick = () => notification.remove();
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Close modal when clicking outside
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = 'none';
        }
    }
    
    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }
    });
});

// Initialize reminder timing change listener
document.addEventListener('change', function(e) {
    if (e.target.id === 'reminderTiming') {
        const showOffset = e.target.value !== 'exact';
        document.getElementById('reminderOffset').style.display = showOffset ? 'inline-block' : 'none';
        document.getElementById('offsetUnit').style.display = showOffset ? 'inline' : 'none';
    }
});
</script>
</body>
</html>
